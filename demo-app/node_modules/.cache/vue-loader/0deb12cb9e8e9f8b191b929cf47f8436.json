{"remainingRequest":"/Volumes/Voorhoede/www/deltares/delta-vue-components/demo-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Voorhoede/www/deltares/delta-vue-components/component-library/src/components/LayerListControls/LayerListControls.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Voorhoede/www/deltares/delta-vue-components/component-library/src/components/LayerListControls/LayerListControls.vue","mtime":1604563862000},{"path":"/Volumes/Voorhoede/www/deltares/delta-vue-components/demo-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Voorhoede/www/deltares/delta-vue-components/demo-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Voorhoede/www/deltares/delta-vue-components/demo-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Voorhoede/www/deltares/delta-vue-components/demo-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHdhdGNoLCByZWYsIHRvUmVmcywgY29tcHV0ZWQgfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaScKaW1wb3J0IGFkZEluZGV4IGZyb20gJy4vYWRkLWluZGV4JwppbXBvcnQgZmluZEluVHJlZSBmcm9tICcuL2ZpbmQtaW4tdHJlZScKaW1wb3J0IGFkZFBhcmVudElkVG9MYXllcnMgZnJvbSAnLi9hZGQtcGFyZW50LWlkLXRvLWxheWVycycKaW1wb3J0IHVzZUxlZ2VuZCBmcm9tICcuL3VzZUxlZ2VuZCcKaW1wb3J0IHVzZVNlbGVjdGVkIGZyb20gJy4vdXNlU2VsZWN0ZWQnCmltcG9ydCB1c2VTb3J0YWJsZSBmcm9tICcuL3VzZVNvcnRhYmxlJwoKY29uc3QgZGVsZXRlSW5kZXggPSBpdGVtID0+IHsKICBkZWxldGUgaXRlbS5pbmRleAogIHJldHVybiBpbmRleAp9CgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsgbGF5ZXJzOiBBcnJheSB9LAogIHNldHVwKHByb3BzLCBjb250ZXh0KSB7CiAgICBjb25zdCByb290ID0gcmVmKG51bGwpCiAgICBjb25zdCBvcGVuSXRlbXMgPSByZWYoW10pCiAgICBjb25zdCB7IGxheWVycyB9ID0gdG9SZWZzKHByb3BzKQogICAgY29uc3QgbGF5ZXJzV2l0aFBhcmVudHMgPSBjb21wdXRlZCgoKSA9PiBhZGRQYXJlbnRJZFRvTGF5ZXJzKGxheWVycy52YWx1ZSkpCiAgICBjb25zdCBsYXllcnNBcmVQcm92aWRlZCA9IGNvbXB1dGVkKCgpID0+IGxheWVyc1dpdGhQYXJlbnRzLnZhbHVlLmxlbmd0aCA+IDApCiAgICBjb25zdCB7IHNldFNlbGVjdGVkSWRzLCBzZWxlY3RlZElkcyB9ID0gdXNlU2VsZWN0ZWQoKQogICAgY29uc3QgeyBhY3RpdmVMZWdlbmQsIHNldEFjdGl2ZUxlZ2VuZCB9ID0gdXNlTGVnZW5kKHNlbGVjdGVkSWRzKQogICAgY29uc3QgeyBvblNvcnRpbmdDaGFuZ2UgfSA9IHVzZVNvcnRhYmxlKGxheWVycywgcm9vdCwgb3Blbkl0ZW1zKQoKICAgIGNvbnN0IHNvcnRlZFNlbGVjdGVkTGF5ZXJzID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBjb25zdCB3aXRoSW5kZXggPSBhZGRJbmRleChsYXllcnMudmFsdWUpCiAgICAgIHJldHVybiBzZWxlY3RlZElkcy52YWx1ZQogICAgICAgIC5tYXAoaWQgPT4gZmluZEluVHJlZSh3aXRoSW5kZXgsICdpZCcsIGlkKSkKICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5pbmRleCAtIGEuaW5kZXgpCiAgICAgICAgLm1hcChkZWxldGVJbmRleCkKICAgIH0pCgogICAgb25Tb3J0aW5nQ2hhbmdlKHNvcnRlZExheWVycyA9PiBjb250ZXh0LmVtaXQoJ2xheWVyLXNvcnRpbmctY2hhbmdlJywgc29ydGVkTGF5ZXJzKSkKICAgIHdhdGNoKGFjdGl2ZUxlZ2VuZCwgbmV3QWN0aXZlTGVnZW5kID0+IGNvbnRleHQuZW1pdCgnbGVnZW5kLWNoYW5nZScsIG5ld0FjdGl2ZUxlZ2VuZCkpCiAgICB3YXRjaChzb3J0ZWRTZWxlY3RlZExheWVycywgc29ydGVkU2VsZWN0ZWQgPT4gY29udGV4dC5lbWl0KCdhY3RpdmUtbGF5ZXJzLWNoYW5nZScsIHNvcnRlZFNlbGVjdGVkKSkKCiAgICByZXR1cm4geyByb290LCBvcGVuSXRlbXMsIGxheWVyc0FyZVByb3ZpZGVkLCBhY3RpdmVMZWdlbmQsIHNldEFjdGl2ZUxlZ2VuZCwgc2V0U2VsZWN0ZWRJZHMsIGxheWVyc1dpdGhQYXJlbnRzIH0KICB9LAp9Cg=="},{"version":3,"sources":["LayerListControls.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"LayerListControls.vue","sourceRoot":"../component-library/src/components/LayerListControls","sourcesContent":["<template>\n  <div v-if=\"layersAreProvided\" ref=\"root\">\n    <v-treeview\n      :open.sync=\"openItems\"\n      selectable\n      :items=\"layersWithParents\"\n      @input=\"setSelectedIds\"\n      :open-all=\"true\"\n    >\n      <template v-slot:label=\"{ item, selected }\">\n        <div class=\"d-flex align-center\">\n          <span\n            class=\"sortable-handle\"\n            :data-id=\"item.id\"\n            :data-parent-ids=\"item.parentIds.toString()\"\n          >{{ item.name }}</span>\n          <v-btn\n            v-if=\"item.layer && selected\"\n            icon\n            class=\"ml-auto\"\n            @click=\"setActiveLegend(item.id)\"\n          >\n            <v-icon>\n              mdi-card-bulleted{{\n                item.id === activeLegend ? '' : '-off'\n              }}-outline\n            </v-icon>\n          </v-btn>\n        </div>\n      </template>\n    </v-treeview>\n  </div>\n</template>\n\n<script>\nimport { watch, ref, toRefs, computed } from '@vue/composition-api'\nimport addIndex from './add-index'\nimport findInTree from './find-in-tree'\nimport addParentIdToLayers from './add-parent-id-to-layers'\nimport useLegend from './useLegend'\nimport useSelected from './useSelected'\nimport useSortable from './useSortable'\n\nconst deleteIndex = item => {\n  delete item.index\n  return index\n}\n\nexport default {\n  props: { layers: Array },\n  setup(props, context) {\n    const root = ref(null)\n    const openItems = ref([])\n    const { layers } = toRefs(props)\n    const layersWithParents = computed(() => addParentIdToLayers(layers.value))\n    const layersAreProvided = computed(() => layersWithParents.value.length > 0)\n    const { setSelectedIds, selectedIds } = useSelected()\n    const { activeLegend, setActiveLegend } = useLegend(selectedIds)\n    const { onSortingChange } = useSortable(layers, root, openItems)\n\n    const sortedSelectedLayers = computed(() => {\n      const withIndex = addIndex(layers.value)\n      return selectedIds.value\n        .map(id => findInTree(withIndex, 'id', id))\n        .sort((a, b) => b.index - a.index)\n        .map(deleteIndex)\n    })\n\n    onSortingChange(sortedLayers => context.emit('layer-sorting-change', sortedLayers))\n    watch(activeLegend, newActiveLegend => context.emit('legend-change', newActiveLegend))\n    watch(sortedSelectedLayers, sortedSelected => context.emit('active-layers-change', sortedSelected))\n\n    return { root, openItems, layersAreProvided, activeLegend, setActiveLegend, setSelectedIds, layersWithParents }\n  },\n}\n</script>\n\n<style>\n.sortable-handle {\n  cursor: grab;\n}\n</style>"]}]}